---
title: "202-primer-region"
output: html_document
date: "2023-10-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(viridis)
```

These ones are the ones with potential variants in the primer region:
(base) Macs-MacBook-Pro-2:201 mac$ gunzip -c ../200/snps-90-broodstock.geno.gz  | cut -f 1,2 | sort -k 2 -n
Atr_54160-70,T,C,TCATTTTTGGGTC,TCATTTTCGGGTC,TTTGCGGTTCAGATGTGGGT,0,0	9
Atr_64006-52,C,T,GGTTTACCCTGAAG,GGTTTACTCTGAAG,CTGGATGGGGAGCGGTTTAC,0,0	9
Atr_70167-40,C,T,CAGACCTCGTCCTG,CAGACCTTGTCCTG,GCATGCATCAGATAGCCAGC,0,0	12
Atr_48754-60,G,A,CTGCAACGACGTGT,CTGCAACAACGTGT,GCTTTCTCCTTTCAGTGGCC,0,0	14
Atr_64006-52,C,T,GGTTTACCCTGAAG,GGTTTACTCTGAAG,CTGGATGGGGAGCGGTTTAC,0,0	14
Atr_1720-33,C,A,GGGGGCTTTGAGAGC,GGGGGATTTGAGAGC,GGCAAAGCAGAAGGGGG,0,0.7	18
Atr_54160-70,T,C,TCATTTTTGGGTC,TCATTTTCGGGTC,TTTGCGGTTCAGATGTGGGT,0,0	18
Atr_29086-33,C,T,TTGTCAACGGGTTT,TTGTCAATGGGTTT,GGTTTGGTTCAACCGCACAG,0,0	19
Atr_58434-42,G,A,CCAGTCCGTTTTCC,CCAGTCCATTTTCC,GCAGAACCACGCCAGTCC,0,1.5	19
Atr_70167-40,C,T,CAGACCTCGTCCTG,CAGACCTTGTCCTG,GCATGCATCAGATAGCCAGC,0,0	19
Atr_18334-74,A,G,ATGGTGGAC,ATGGTGGGC,GGAAGTTGGTCCTCAGAGGC,0,0	20
Atr_23070-31,C,A,CAGTCTCCGCATTT,CAGTCTCAGCATTT,GCCTTTGCCCTCCAGTCTC,0,0	20
Atr_36485-28,C,T,CCTCATCCTAGCCC,CCTCATCTTAGCCC,GGTGCTAGCAGCCCTCATC,0,0	20
Atr_60368-72,A,T,AGGAACCAGCA,AGGAACCTGCA,CGATGGCCTCCAAGGAACC,0,0	20

_1_

Atr_54160-70,T,C,TCATTTTTGGGTC,TCATTTTCGGGTC,TTTGCGGTTCAGATGTGGGT,0,0 9
Atr_54160-70,T,C,TCATTTTTGGGTC,TCATTTTCGGGTC,TTTGCGGTTCAGATGTGGGT,0,0	18
perl -pi -e 's/^TTTGCGGT[G|T]CAGATGTG[A|G]GT/TTTGCGGTTCAGATGTGGGT/' 



_2_   

Atr_64006-52,C,T,GGTTTACCCTGAAG,GGTTTACTCTGAAG,CTGGATGGGGAGCGGTTTAC,0,0	9
Atr_64006-52,C,T,GGTTTACCCTGAAG,GGTTTACTCTGAAG,CTGGATGGGGAGCGGTTTAC,0,0	14
perl -pi -e 's/^CTGGATGG[A|G]GAGC[A|G]GTTTAC/CTGGATGGGGAGCGGTTTAC/' *.fastq

_3_ 

Atr_70167-40,C,T,CAGACCTCGTCCTG,CAGACCTTGTCCTG,GCATGCATCAGATAGCCAGC,0,0	12
Atr_70167-40,C,T,CAGACCTCGTCCTG,CAGACCTTGTCCTG,GCATGCATCAGATAGCCAGC,0,0	19
perl -pi -e 's/^GCATGCATCAG[A|T]TAGCCA[A|G|C]C/GCATGCATCAGATAGCCAGC/' *.fastq


_4_

Atr_48754-60,G,A,CTGCAACGACGTGT,CTGCAACAACGTGT,GCTTTCTCCTTTCAGTGGCC,0,0	14


perl -pi -e 's/^GCTTTCTCCTTTC[A|T]GTGGCC/GCTTTCTCCTTTCAGTGGCC/' *.fastq

Need to edit a couple and see how it goes.
```{sh, eval=FALSE}
cp ../../data/broodstock/1BF26FDD87_S1132_L002_R1_001.fastq  .
cp ../../data/broodstock/1C2D44F136_S974_L002_R1_001.fastq .
cp ../../data/broodstock/7F7D3F627C_S1313_L002_R1_001.fastq .
cp ../../data/broodstock/127975561A_S1362_L002_R1_001.fastq  .

perl -pi -e 's/^TTTGCGGT[G|T]CAGATGTG[A|G]GT/TTTGCGGTTCAGATGTGGGT/' *.fastq
perl -pi -e 's/^CTGGATGG[A|G]GAGC[A|G]GTTTAC/CTGGATGGGGAGCGGTTTAC/' *.fastq
perl -pi -e 's/^GCATGCATCAG[A|T]TAGCCA[A|G|C]C/GCATGCATCAGATAGCCAGC/' *.fastq
perl -pi -e 's/^GCTTTCTCCTTTC[A|T]GTGGCC/GCTTTCTCCTTTCAGTGGCC/' *.fastq
```

```{r}
testinds<-c("1BF26FDD87_S1132","1C2D44F136_S974","7F7D3F627C_S1313","127975561A_S1362")
testtibble<-testinds %>% as_tibble() %>% rename(SeqID=value) %>%
  mutate(Command1=paste0("perl ./data-processing-files/GTseq_Genotyper_v3_Tetra.pl", 
                         " 202.1-primer-loci.csv ",
         paste0("data/broodstock/",SeqID,"_L002_R1_001.fastq"), " > ", "outputs/202/",SeqID,".org")) %>%
  mutate(Command2=paste0("perl ./data-processing-files/GTseq_Genotyper_v3_Tetra.pl", 
                         " 202.1-primer-loci.csv ",
         paste0("outputs/202/",SeqID,"_L002_R1_001.fastq"), " > ", "outputs/202/",SeqID,".edited"))


testtibble %>% select(Command1) %>% write_tsv("202.2-primer-commands.sh", col_names = FALSE)
testtibble %>% select(Command2) %>% write_tsv("202.3-primer-commands.sh", col_names = FALSE)

```


for f in *.edited; do echo $f; cat $f | tail -n +2 >> 202-edited.csv; done;
for f in *.org; do echo $f; cat $f | tail -n +2 >> 201-original.csv; done;

(base) maccamp@farm:~/kootenai/outputs/202$ cat 201-original.csv 
Atr_48754-60,G=50,A=0,500.000,GGGG,A1HOM,0,0,50,50.5,6.394,Pass,3
Atr_54160-70,T=188,C=187,1.005,TTCC,HET2,0,0,375,7.0,47.954,Pass,12
Atr_64006-52,C=266,T=0,2660.000,CCCC,A1HOM,0,0,266,19.9,34.015,Pass,8
Atr_70167-40,C=0,T=91,0.001,TTTT,A2HOM,0,0,91,13.5,11.637,Pass,48
Atr_48754-60,G=128,A=0,1280.000,GGGG,A1HOM,0,0,128,85.9,5.313,Pass,3
Atr_54160-70,T=553,C=530,1.043,TTCC,HET2,0,0,1083,46.4,44.956,Pass,34
Atr_64006-52,C=1054,T=4,263.500,CCCC,A1HOM,0,0,1058,76.9,43.919,Pass,30
Atr_70167-40,C=75,T=65,1.154,CCTT,HET2,0,0,140,31.2,5.812,Pass,98
Atr_48754-60,G=35,A=0,350.000,GGGG,A1HOM,0,0,35,35.4,8.121,Pass,0
Atr_54160-70,T=149,C=45,3.311,TTTC,HET1,0,0,194,4.4,45.012,Pass,4
Atr_64006-52,C=157,T=0,1570.000,CCCC,A1HOM,0,0,157,13.7,36.427,Pass,1
Atr_70167-40,C=11,T=34,0.324,CTTT,HET3,0,0,45,10.0,10.441,Pass,22
Atr_48754-60,G=1,A=0,10.000,0000,NA,0,0,1,1.2,11.111,Pass,0
Atr_54160-70,T=0,C=3,0.033,0000,NA,0,0,3,0.1,33.333,Pass,0
Atr_64006-52,C=3,T=1,3.000,0000,NA,0,0,4,0.2,44.444,Pass,0
Atr_70167-40,C=0,T=1,0.100,0000,NA,0,0,1,0.1,11.111,Pass,1

(base) maccamp@farm:~/kootenai/outputs/202$ cat 202-edited.csv 
Atr_48754-60,G=50,A=0,500.000,GGGG,A1HOM,0,0,50,37.9,6.394,Pass,3
Atr_54160-70,T=188,C=187,1.005,TTCC,HET2,0,0,375,3.7,47.954,Pass,12
Atr_64006-52,C=266,T=0,2660.000,CCCC,A1HOM,0,0,266,12.9,34.015,Pass,8
Atr_70167-40,C=0,T=91,0.001,TTTT,A2HOM,0,0,91,5.9,11.637,Pass,48
Atr_48754-60,G=128,A=0,1280.000,GGGG,A1HOM,0,0,128,74.4,5.313,Pass,3
Atr_54160-70,T=553,C=530,1.043,TTCC,HET2,0,0,1083,29.2,44.956,Pass,34
Atr_64006-52,C=1054,T=4,263.500,CCCC,A1HOM,0,0,1058,71.5,43.919,Pass,30
Atr_70167-40,C=75,T=65,1.154,CCTT,HET2,0,0,140,14.2,5.812,Pass,98
Atr_48754-60,G=35,A=0,350.000,GGGG,A1HOM,0,0,35,24.8,8.121,Pass,0
Atr_54160-70,T=149,C=45,3.311,TTTC,HET1,0,0,194,2.3,45.012,Pass,4
Atr_64006-52,C=157,T=0,1570.000,CCCC,A1HOM,0,0,157,9.2,36.427,Pass,1
Atr_70167-40,C=11,T=34,0.324,CTTT,HET3,0,0,45,3.7,10.441,Pass,22
Atr_48754-60,G=1,A=0,10.000,0000,NA,0,0,1,0.6,11.111,Pass,0
Atr_54160-70,T=0,C=3,0.033,0000,NA,0,0,3,0.0,33.333,Pass,0
Atr_64006-52,C=3,T=1,3.000,0000,NA,0,0,4,0.1,44.444,Pass,0
Atr_70167-40,C=0,T=1,0.100,0000,NA,0,0,1,0.0,11.111,Pass,1

This didn't change anything.   
